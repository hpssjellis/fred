<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Spinning 3D Model</title>
    <style>
        body {
            margin: 0;
        }
        canvas {
            display: block;
        }
    </style>
</head>
<body>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three/examples/js/loaders/FBXLoader.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.132.2/examples/js/loaders/GLTFLoader.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/fflate@0.8.0/umd/index.min.js"></script>

    <script>
        // Create a scene
        const scene = new THREE.Scene();

        // Create the camera
        const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 10000);

        // Create a directional light
        const directionalLight = new THREE.DirectionalLight(0xffffff, 1);
        directionalLight.position.set(1, 1, 1);
        scene.add(directionalLight);

        // Create an ambient light for overall scene illumination
        const ambientLight = new THREE.AmbientLight(0x404040, 1.5, 10); // Adjust the color as needed
        scene.add(ambientLight);

        // Create a point light for localized illumination (e.g., spotlight)
        const pointLight = new THREE.PointLight(0xff0000, 1, 10); // Color, intensity, distance
        pointLight.position set(0, 1, 0); // Adjust the position
        scene.add(pointLight);

        directionalLight.position.set(1, 1, 1);
        directionalLight.castShadow = true; // Enable shadow casting

        // Configure shadow properties
        directionalLight.shadow.mapSize.width = 1024; // Shadow map width
        directionalLight.shadow.mapSize.height = 1024; // Shadow map height
        directionalLight.shadow.camera.near = 0.1; // Near plane of the shadow camera
        directionalLight.shadow.camera.far = 10; // Far plane of the shadow camera

        scene.add(directionalLight);

        // Create a renderer
        const renderer = new THREE.WebGLRenderer();
        renderer.setSize(window.innerWidth, window.innerHeight);
        document.body.appendChild(renderer.domElement);

        let model; // Initialize model variable
        const loader1 = new THREE.FBXLoader();

        loader1.load('t1a06-armature-jeremy.fbx', function (object) {
            model = object;
            model.scale.set(0.3, 0.3, 0.3);
            scene.add(model);

            // Set the position of the camera behind the gun
            const cameraDistance = 5; // Adjust the distance as needed
            const cameraHeight = 0;   // Adjust the height as needed

            camera.position.set(
                model.position.x - cameraDistance,
                model.position.y + cameraHeight,
                model.position.z
            );

            // Point the camera at the gun
            camera.lookAt(model.position);

            // Configure shadow-receiving materials for objects (e.g., 'gun')
            if (model) {
                model.traverse((child) => {
                    if (child instanceof THREE.Mesh) {
                        child.castShadow = true; // Enable shadow casting
                        child.receiveShadow = true; // Enable shadow receiving
                    }
                });
            }
        });

        // Set up animation
        const animate = () => {
            requestAnimationFrame(animate);

            // Rotate the model (change 'model' to 'gun')
            if (model) {
                model.rotation.y -= 0.005;
            }

            renderer.render(scene, camera);
        };

        // Handle window resize
        window.addEventListener('resize', () => {
            const newWidth = window.innerWidth;
            const newHeight = window.innerHeight;

            camera.aspect = newWidth / newHeight;
            camera.updateProjectionMatrix();

            renderer.setSize(newWidth, newHeight);
        });

        animate();
    </script>
</body>
</html>

