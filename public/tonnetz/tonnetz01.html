<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Euler Tonnetz in 2D and 3D</title>
</head>
<body>
  <input type="button" value="Start" onclick="myinit()"><br>
  <canvas id="myCanvas2D" width="400" height="400" style="border:1px solid gray"></canvas><br>
  <div id="my3DContainer"></div>

<script type="module">
import * as THREE from 'https://cdn.jsdelivr.net/npm/three@0.174.0/build/three.module.js';
import { OrbitControls } from 'https://cdn.jsdelivr.net/npm/three@0.174.0/examples/jsm/controls/OrbitControls.js';

function myinit() {
  let myctx = document.getElementById("myCanvas2D").getContext("2d");
  myctx.clearRect(0, 0, 400, 400);
  myctx.font = "20px sans-serif";

  let size = 50;
  for (let x = 0; x < 5; x++) {
    for (let y = 0; y < 5; y++) {
      let xOffset = (y % 2) * (size / 2);
      myctx.beginPath();
      myctx.arc(x * size + xOffset + 50, y * size + 50, 20, 0, 2 * Math.PI);
      myctx.stroke();
      myctx.fillText("E", x * size + xOffset + 44, y * size + 54);
    }
  }

  let myscene = new THREE.Scene();
  let mycamera = new THREE.PerspectiveCamera(75, 1, 0.1, 1000);
  let myrenderer = new THREE.WebGLRenderer();
  myrenderer.setSize(400, 400);
  document.getElementById("my3DContainer").appendChild(myrenderer.domElement);

  let mycontrols = new OrbitControls(mycamera, myrenderer.domElement);
  mycamera.position.z = 5;

  for (let x = -2; x <= 2; x++) {
    for (let y = -2; y <= 2; y++) {
      let mygeometry = new THREE.SphereGeometry(0.2, 16, 16);
      let mymaterial = new THREE.MeshBasicMaterial({ color: 0x00ff00, wireframe: true });
      let mysphere = new THREE.Mesh(mygeometry, mymaterial);
      mysphere.position.set(x, y, Math.sin(x + y));
      myscene.add(mysphere);
    }
  }

  function myanimate() {
    requestAnimationFrame(myanimate);
    mycontrols.update();
    myrenderer.render(myscene, mycamera);
  }

  myanimate();
}
</script>
</body>
</html>
